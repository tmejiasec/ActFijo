<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html   xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:p="http://primefaces.org/ui"
        xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"        
        xmlns:ui="http://java.sun.com/jsf/facelets">

    <ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                    template="./../plantillas/plantilla2.xhtml">


        <ui:define name="content">
            <ul class="nav nav-tabs">
                <li class=""><a aria-expanded="true" href="#adicion" data-toggle="tab">Adición</a></li>
                <li class="active"><a aria-expanded="false" href="#consulta" data-toggle="tab">Consulta</a></li>
                <li class=""><a aria-expanded="false" href="#seguimiento" data-toggle="tab">Seguimiento</a></li>
                <li class=""><a aria-expanded="false" href="#imagenes" data-toggle="tab">Imágenes</a></li>
                <li class=""><a aria-expanded="false" href="#codigo" data-toggle="tab">Código</a></li>
            </ul>
            <div id="myTabContent" class="tab-content">
                <div class="tab-pane fade" id="adicion">
                    <div class="well bs-component">
                        <h:form id="adiMBien" class="form-horizontal" enctype="multipart/form-data" >
                            <p:growl id="growl" />
                            <legend>
                                <div class="form-header">
                                    <button type="button" class="close"  aria-hidden="true">Cancelar ×</button>
                                    <h4 class="modal-title">Adición de Movimientos de Bienes Muebles</h4>
                                </div>
                            </legend>
                            <div class="form-group">
                                <div class="col-md-3">
                                    <label >Tipo de Movimiento</label>
                                    <h:selectOneMenu id="tipmov" value="#{movBienesBean.tipmSeleccionado}" style="width: 100%;" >
                                        <f:selectItem itemLabel="Seleccione uno..." noSelectionOption="true" itemValue=""/>
                                        <f:selectItems value="#{movBienesBean.tiposm}" var="tipm" itemLabel="#{tipm.CTipmDesc}" itemValue="#{tipm.CTipmId}" />
                                        <p:ajax  listener="#{movBienesBean.tipSelec()}" update="tipmov"/>                    
                                    </h:selectOneMenu>                                    
                                </div>
                                <div class="col-md-3">
                                    <label for="anio" >Año</label>
                                    <div>
                                        <p:inputText id="anio" value="#{movBienesBean.nuevoEnca.TMoveAnio}"> 
                                            <p:ajax listener="#{movBienesBean.buscarCorr}" update="@this :adiMBien:growl :adiMBien:corr"/>
                                        </p:inputText>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label >Correlativo</label>
                                    <div>
                                        <h:outputText id="corr" value="#{movBienesBean.nuevoEnca.TMoveCorr}"/>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label >Estado del Movimiento</label>
                                    <h:selectOneMenu value="#{movBienesBean.estmoSeleccionado}">
                                        <f:selectItem itemLabel="Seleccione uno..." noSelectionOption="true" itemValue=""/>
                                        <f:selectItems value="#{movBienesBean.estmovs}" var="estmo" itemLabel="#{estmo.CEstmovDesc}" itemValue="#{estmo.CEstmovId}" />
                                        <!--<p:ajax  listener="{movBienesBean.tipSelec()}" update="tipmo"/>-->                    
                                    </h:selectOneMenu>                                        
                                </div>                                
                            </div>
                            <div class="form-group">
                                <div class="col-md-3">
                                    <label >Nivel Organizativo Solicitante</label>
                                    <div >
                                        <h:selectOneMenu id="nivels" value="#{movBienesBean.nuevoEnca.TMoveNivs}" style="width: 100%;" >
                                            <f:selectItem itemLabel="Seleccione uno..." noSelectionOption="true" itemValue=""/>
                                            <f:selectItems value="#{movBienesBean.niveles}" var="niv" itemLabel="#{niv.CNivelDescrip}" itemValue="#{niv.CNivelId}" />
                                            <p:ajax  listener="#{movBienesBean.depSeleccionA()}" update="depen"/>                         
                                        </h:selectOneMenu>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label >Dependencia Solicitante</label>
                                    <div >
                                        <h:selectOneMenu id="depen" value="#{movBienesBean.nuevoEnca.TMoveDeps}" style="width: 100%" >
                                            <f:selectItem itemLabel="Seleccione una..." noSelectionOption="true" itemValue=""/>
                                            <f:selectItems value="#{movBienesBean.depens}" var="depe" itemLabel="#{depe.CDepenDesc}" itemValue="#{depe.CDepenId}"/>
                                        </h:selectOneMenu>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label for="respos" >Persona Solicitante</label>
                                    <h:selectOneMenu id="respos" value="#{movBienesBean.nuevoEnca.TMovePers}" style="width: 100%" >
                                        <f:selectItem itemLabel="Seleccione uno..." noSelectionOption="true" itemValue=""/>
                                        <f:selectItems value="#{movBienesBean.respons}" var="resp" itemLabel="#{resp.CRespApe1} #{resp.CRespApe2} #{resp.CRespApec} #{resp.CRespNom1} #{resp.CRespNom2}" itemValue="#{resp.CRespId}"/>
                                    </h:selectOneMenu>  
                                </div>
                                <div class="col-md-3">
                                    <label for="cargos" >Cargo de Persona Solicitante</label>
                                    <h:outputText id="cargos" value="#{resp.CRespCargo}"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-3">
                                    <label >Nivel Organizativo Responsable</label>
                                    <div >
                                        <h:selectOneMenu id="nivel" value="#{movBienesBean.nuevoEnca.TMoveNive}" style="width: 100%;" >
                                            <f:selectItem itemLabel="Seleccione uno..." noSelectionOption="true" itemValue=""/>
                                            <f:selectItems value="#{movBienesBean.niveles}" var="nive" itemLabel="#{nive.CNivelDescrip}" itemValue="#{nive.CNivelId}" />
                                            <p:ajax  listener="#{movBienesBean.depSeleccionE()}" update="depene"/>                         
                                        </h:selectOneMenu>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label >Dependencia Responsable</label>
                                    <div >
                                        <h:selectOneMenu id="depene" value="#{movBienesBean.nuevoEnca.TMoveDepe}" style="width: 100%" >
                                            <f:selectItem itemLabel="Seleccione una..." noSelectionOption="true" itemValue=""/>
                                            <f:selectItems value="#{movBienesBean.depense}" var="deper" itemLabel="#{deper.CDepenDesc}" itemValue="#{deper.CDepenId}"/>
                                        </h:selectOneMenu>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label for="respoe" >Persona Responsable del Bien</label>
                                    <h:selectOneMenu id="respo" value="#{movBienesBean.nuevoEnca.TMovePere}" style="width: 100%" >
                                        <f:selectItem itemLabel="Seleccione uno..." noSelectionOption="true" itemValue=""/>
                                        <f:selectItems value="#{movBienesBean.respons}" var="respe" itemLabel="#{respe.CRespApe1} #{respe.CRespApe2} #{respe.CRespApec} #{respe.CRespNom1} #{respe.CRespNom2}" itemValue="#{respe.CRespId}"/>
                                    </h:selectOneMenu>  
                                </div>
                                <div class="col-md-3">
                                    <label for="cargor" >Cargo de Persona Responsable</label>
                                    <h:outputText id="cargor" value="#{respe.CRespCargo}"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-3">
                                    <label >Tipo de Préstamo/Reparación</label>
                                    <h:selectOneMenu value="#{movBienesBean.nuevoEnca.TMoveTipt}">
                                        <f:selectItem itemValue="I" itemLabel="Interno" />
                                        <f:selectItem itemValue="E" itemLabel="Externo" />
                                    </h:selectOneMenu>                                        
                                </div>             
                                <div class="col-md-3">
                                    <label for="fecs">Fecha de Salida del Bien</label>
                                    <div>
                                        <p:calendar id="fecs"
                                                    value="#{movBienesBean.nuevoEnca.TMoveFecsal}" locale="es"
                                                    pattern="dd/MM/yyyy" showOn="button" 
                                                    size="12" tabindex="2" style="width: 100%;">
                                            <p:ajax event="dateSelect" />
                                        </p:calendar>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label for="fecr">Fecha de Retorno del Bien</label>
                                    <div>
                                        <p:calendar id="fecr"
                                                    value="#{movBienesBean.nuevoEnca.TMoveFecret}" locale="es"
                                                    pattern="dd/MM/yyyy" showOn="button" 
                                                    size="12" tabindex="2" style="width: 100%;">
                                            <p:ajax event="dateSelect" />
                                        </p:calendar>
                                    </div>
                                </div>  
                                <div class="col-md-3">
                                    <label for="depre" >Hay Documento que respalda el Préstamo?</label>
                                    <h:selectOneRadio value="#{movBienesBean.nuevoEnca.TMoveDocp}" required="true">
                                        <f:selectItem itemValue="TRUE" itemLabel="Si"/>
                                        <f:selectItem itemValue="FALSE" itemLabel="No"/></h:selectOneRadio>
                                </div> 
                            </div>
                            <div class="form-group">
                                <h:outputLabel value="Observaciones: " />
                                <p:inputTextarea value="#{movBienesBean.nuevoEnca.TMoveObser}"
                                                 rows="3" style="width: 98%;" autoResize="false" tabindex="9"/>
                            </div>
                            <div class="form-group">
                                <div class="col-lg-8 col-lg-offset-6">
                                    <p:commandButton id="guard"  value="Guardar Encabezado"  action="#{movBienesBean.guardarE()}"  rendered="#{!movBienesBean.edit}" disabled="#{movBienesBean.estado}" update="@this guard adiComP adiComR" process="@this adiMBien"  oncomplete="handleRequest(xhr, status, args);" />
                                    <script type="text/javascript">
                                        function handleRequest(xhr, status, args) {
                                            if (args.validationFailed) {
                                                alert('Ha ocurrido un error. Complete los datos necesarios');
                                            } else {
                                                alert('Datos adicionados correctamente');
                                            }
                                        }
                                    </script>
                                    <h:commandButton id="adiComP" value="Préstamo Externo"  pt:data-toggle="modal" pt:data-target="#adComP" disabled="#{movBienesBean.estadoC}" >
                                        <f:setPropertyActionListener value="#{movBienesBean.enca}" target="#{movBienesBean.encSeleccionado}" />
                                        <p:ajax process="@this" update=":adiMBien:displayPt2"/>
                                    </h:commandButton>

                                    <h:commandButton id="adiComR" value="Reparación Externa"  pt:data-toggle="modal" pt:data-target="#adComR" disabled="#{movBienesBean.estadoR}">
                                        <f:setPropertyActionListener value="#{movBienesBean.enca}" target="#{movBienesBean.encSeleccionado}" />
                                        <p:ajax process="@this" update=":adiMBien:displayRe2"/>
                                    </h:commandButton>

                                    <!--copiar siguiente bloque en agregar otro mov despues de grabar detalle-->

                                </div>

                            </div>
                            <!--aqui agregar dialogo para adicionar datos complementarios-->

                            <!--aqui agregar tabla de detalle de movimientos-->
                            <div class="table table-responsive table-bordered" >
                                <table id="detmov" class="table table-striped table-condensed paginada" >
                                    <thead>
                                        <tr align="center">
                                            DETALLE DE BIENES MUEBLES
                                        </tr>
                                        <tr>
                                            <th>Código</th>
                                            <th>Descripción</th>
                                            <th>Marca</th>
                                            <th>Modelo</th>
                                            <th>Serie</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ui:repeat value="#{movBienesBean.movdeta}" var="dbien" >
                                            <tr>
                                                <td>#{dbien.TMovdCodigo}</td>
                                                <td>#{dbien.TBienId.TBienDesc}</td>
                                                <td>#{dbien.TBienId.CMarcaId.CMarcaDesc}</td>
                                                <td>#{dbien.TBienId.TBienModelo}</td>
                                                <td>#{dbien.TBienId.TBienSerie}</td>
                                            </tr>
                                        </ui:repeat>
                                        <div class="col-md-6" align="center" >
                                            <a data-toggle="modal" href="#adicDetmov" class="btn btn-primary" ><span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span>Adicionar Bienes</a>
                                        </div>                              

                                    </tbody>  
                                </table>
                            </div>
                            <!--// probar aqui-->

                            <div id="adicDetmov" class="modal">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                            <h4 class="modal-title">Seleccionar Bienes a Agregar a Movimiento</h4>
                                        </div>
                                        <div class="modal-body">
                                            <!--// aqui poner datatable para seleccion multiple-->
                                        </div>
                                        <div class="modal-footer">
                                            <button class="btn btn-default">Cancelar</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="adComP" class="modal">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                            <h4 class="modal-title">Datos para Préstamo Externo</h4>
                                        </div>
                                        <div class="modal-body" id="adiPt2">
                                            <h:panelGroup id="displayPt2"> 
                                                <div class="form-group">
                                                    <div class="col-md-5">
                                                        <label >No. de Préstamo Externo</label>
                                                        <h:outputText value="#{movBienesBean.nuevoPrest.TPrestId}" />
                                                    </div>
                                                    <div class="col-md-7">
                                                        <label >Nombre de la Institución</label>
                                                        <h:inputText value="#{movBienesBean.nuevoPrest.TPrestInst}" style="width: 100%" required="true"/> 
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-6">
                                                        <label >Persona Solicitante</label>
                                                        <h:inputText value="#{movBienesBean.nuevoPrest.TPrestSolic}" style="width: 100%" required="true" /> 
                                                    </div>
                                                    <div class="col-md-3">
                                                        <label >Cargo</label>
                                                        <h:inputText value="#{movBienesBean.nuevoPrest.TPrestCargo}" style="width: 100%" /> 
                                                    </div>
                                                    <div class="col-md-3">
                                                        <label >Teléfono</label>
                                                        <h:inputText value="#{movBienesBean.nuevoPrest.TPrestTelef}" style="width: 100%" /> 
                                                    </div>
                                                </div>
                                                <p:commandButton value="Guardar Datos" icon="ui-icon-disk" action="{movBienesBean.guardarP()}" process="@this displayPt2" update="@all" oncomplete="handleRequest(xhr, status, args); adComP.hide();"/>

                                            </h:panelGroup>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="adComR" class="modal">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                            <h4 class="modal-title">Datos para Reparación Externa</h4>
                                        </div>
                                        <div class="modal-body" id="adiPt2">
                                            <h:panelGroup id="displayRe2"> 
                                                <div class="form-group">
                                                    <div class="col-md-5">
                                                        <label >No. de Reparación Externa</label>
                                                        <h:outputText value="#{movBienesBean.nuevaRepar.TReparId}" />
                                                    </div>
                                                    <div class="col-md-7">
                                                        <label >Nombre del Taller</label>
                                                        <h:inputText value="#{movBienesBean.nuevaRepar.TReparTaller}" style="width: 100%" required="true"/> 
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-6">
                                                        <label >Dirección</label>
                                                        <h:inputText value="#{movBienesBean.nuevaRepar.TReparDirec}" style="width: 100%" required="true" /> 
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label >Contacto</label>
                                                        <h:inputText value="#{movBienesBean.nuevaRepar.TReparContacto}" style="width: 100%" /> 
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-6">
                                                        <label >Persona que retira</label>
                                                        <h:inputText value="#{movBienesBean.nuevaRepar.TReparPret}" style="width: 100%" /> 
                                                    </div>

                                                    <div class="col-md-3">
                                                        <label >Cargo</label>
                                                        <h:inputText value="#{movBienesBean.nuevaRepar.TReparPretCargo}" style="width: 100%" /> 
                                                    </div>
                                                    <div class="col-md-3">
                                                        <label >Teléfono</label>
                                                        <h:inputText value="#{movBienesBean.nuevaRepar.TReparTelef}" style="width: 100%" /> 
                                                    </div>
                                                </div>
                                                <p:commandButton value="Guardar Datos" icon="ui-icon-disk" action="{movBienesBean.guardarR()}" process="@this displayRe2" update="@all" oncomplete="handleRequest(xhr, status, args); adComR.hide();"/>

                                                
                                            </h:panelGroup>
                                        </div>

                                    </div>
                                </div>
                            </div>


                        </h:form>
                        <!--                                    <p:commandButton id="Nuevo" value="Agregar Otro" class="btn btn-primary"
                                                     action="{movBienesBean.limpiarE()}" process="@this" update="@all" oncomplete="refrescar(xhr, status, args);">
                                        <script type="text/javascript">
                                            function refrescar(xhr, status, args) {
                                                if (args.validationFailed) {
                                                    alert('Ha ocurrido un error');
                                                } else {
                                                    location.reload(true);
                                                }
                                            }
                                        </script>


                                    </p:commandButton>-->

                    </div>
                </div>
                <div class="tab-pane fade  active in" id="consulta">
                    <h:head></h:head>                    
                    <h:form id="formMBien" >
                        <div class="table table-responsive table-bordered" >
                            <table id="movbienes" class="table table-striped table-condensed paginada" >
                                <thead>
                                    <tr align="center">
                                        CONSULTA DE MOVIMIENTOS BIENES MUEBLES
                                    </tr>
                                    <tr>
                                        <th>Tipo de Movimiento</th>
                                        <th>Correlativo</th>
                                        <th>Año</th>
                                        <th>Estado</th>
                                        <th >Opciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <ui:repeat value="#{movBienesBean.movenca}" var="mbien" >
                                        <tr>
                                            <td>#{mbien.CTipmId.CTipmDesc}</td>
                                            <td>#{mbien.TMoveCorr}</td>
                                            <td>#{mbien.TMoveAnio}</td>
                                            <td>#{mbien.CEstmovId.CEstmovDesc}</td>
                                            <td>
                                                <h:commandLink value="Editar" class="btn btn-link" pt:data-toggle="modal" pt:data-target="#modifMbien" >
                                                    <f:setPropertyActionListener value="#{mbien}"
                                                                                 target="#{movBienesBean.encaSeleccionado}" />
                                                    <p:ajax process="@this" update=":formMBien:modiMBien:displayB2"/>
                                                </h:commandLink>
                                            </td>
                                        </tr>
                                    </ui:repeat>
                                </tbody>  
                            </table>
                        </div>
                        <div id="modifMbien" class="modal">
                            <div class="modal-dialog">
                                <h:head></h:head>
                                <h:form id="modiMBien" > 
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Cancelar ×</button>
                                            <h4 class="modal-title">Modificación de Encabezado de Movimientos de Bienes Muebles</h4>
                                        </div>
                                        <div class="modal-body">
                                            <div class="panel panel-default">
                                                <div class="panel-body" id="modiPy2">
                                                    <h:panelGroup id="displayB2"> 

                                                    </h:panelGroup>  
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </h:form>
                            </div>
                        </div>
                    </h:form>
                </div>
                <div class="tab-pane fade" id="seguimiento">
                    <h:form id="formSeg" enctype="multipart/form-data" >
                    </h:form>
                </div>

                <div class="tab-pane fade" id="imagenes">
                    <h:form id="formImag" enctype="multipart/form-data" >
                        <p:growl id="growl" />
                        <div class="table table-responsive table-bordered" >
                            <table id="tarchs" class="table table-striped table-condensed paginada">
                                <thead>

                                    <tr align="center">
                                        CONSULTA DE IMAGENES Y DOCUMENTOS DE MOVIMIENTOS DE BIENES
                                    </tr>
                                    <tr>
                                        <th>Correlativo</th>
                                        <th>Código</th>
                                        <th>Tipo</th>
                                        <th>Nombre</th>
                                        <th>Descripción</th>
                                        <th></th>
                                        <th></th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <ui:repeat value="#{movBienesBean.docums}" var="docs" >
                                        <tr>
                                            <td>#{docs.TArchId}</td>
                                            <td>#{docs.TArchCodref}</td>
                                            <td>#{docs.TArchTipref}</td>
                                            <td>#{docs.TArchNombre}</td>
                                            <td>#{docs.TArchDesc}</td>
                                            <td>
                                                <h:commandLink value="Editar" class="btn btn-default" pt:data-toggle="modal" pt:data-target="#modifDoc">
                                                    <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                                    <f:setPropertyActionListener value="#{docs}"
                                                                                 target="#{movBienesBean.archSeleccionado}" />
                                                    <p:ajax process="@this" update=":formImag:modImag:dispDoc2"/>
                                                </h:commandLink>
                                            </td>
                                            <td>
                                                <h:commandLink value="Descargar" class="btn btn-default" pt:data-toggle="modal" pt:data-target="#viewDoc">
                                                    <span class="glyphicon glyphicon-save" aria-hidden="true"></span>
                                                    <f:setPropertyActionListener value="#{docs}"
                                                                                 target="#{movBienesBean.archSeleccionado}" />
                                                    <p:ajax process="@this" update=":formImag:verDoc:dispDocD"/>
                                                </h:commandLink>
                                            </td>
                                            <td>
                                                <h:commandLink value="Eliminar" class="btn btn-default" pt:data-toggle="modal" pt:data-target="#elimDoc">
                                                    <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>                                                    
                                                    <f:setPropertyActionListener value="#{docs}"
                                                                                 target="#{movBienesBean.archSeleccionado}" />
                                                    <p:ajax process="@this" update=":formImag:elimImag:dispDoc3"/>
                                                </h:commandLink>
                                            </td>
                                        </tr>
                                    </ui:repeat>
                                    <div class="col-md-6" align="center" >
                                        <a data-toggle="modal" href="#adiDoc" class="btn btn-primary" ><span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span>Agregar</a>
                                    </div>                              
                                </tbody>  
                            </table>
                        </div>
                        <div id="adiDoc" class="modal">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <h:head></h:head>
                                    <h:form id="formDoc" enctype="multipart/form-data">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                            <h4 class="modal-title">Agregar Imagen/documento</h4>
                                        </div>
                                        <div class="modal-body">
                                            <div class="form-group">
                                                <div class="col-md-3">
                                                    <label for="codi" >Código</label>
                                                    <div>
                                                        <p:inputMask id="codi" value="#{movBienesBean.nuevoArch.TArchCodref}" mask="99-9999-9999" style="width: 100%;"> 
                                                            <p:ajax listener="#{movBienesBean.buscarCodI}" update="@this :formImag:growl :formImag:formDoc:guardI"/>
                                                        </p:inputMask>
                                                    </div>
                                                </div>
                                                <div class="col-md-5">
                                                    <label for="descm" >Descripción</label>
                                                    <div>
                                                        <h:inputText id="descm" value="#{movBienesBean.nuevoArch.TArchDesc}" required="true" style="width: 100%;"/> 
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <label >Tipo de Archivo</label>
                                                    <h:selectOneMenu value="#{movBienesBean.nuevoArch.TArchTipo}">
                                                        <f:selectItem itemValue="F" itemLabel="Foto" />
                                                        <f:selectItem itemValue="D" itemLabel="Documento" />
                                                    </h:selectOneMenu>                                        
                                                </div> 
                                            </div> 
                                            <br></br>
                                            <br></br>
                                            <div class="col-md-12">
                                                <p:panelGrid id="doc1" columns="2" >
                                                    <p:fileUpload id="doc" fileUploadListener="#{movBienesBean.handleFileUpload(event)}" value="#{movBienesBean.picture}" mode="simple" required="true" sizeLimit="1000000" allowTypes="/(\.|\/)(gif|jpe?g|png)$/" update="mesaj" >
                                                        <p:growl id="mesaj" showDetail="true" />
                                                    </p:fileUpload>
                                                    <p:commandButton id="guardI" value="Guardar" ajax="false" disabled="#{movBienesBean.estadoI}" action="#{movBienesBean.guardarImagen()}" />
                                                </p:panelGrid>  
                                            </div>
                                            <br></br>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Cancelar</button>
                                        </div>
                                    </h:form>
                                </div>
                            </div>
                        </div>
                        <div id="modifDoc" class="modal">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <h:head></h:head>
                                    <h:form id="modImag" enctype="multipart/form-data">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                            <h4 class="modal-title">Modificación de Documentos e Imágenes</h4>
                                        </div>
                                        <div class="modal-body">
                                            <h:panelGroup id="dispDoc2"  >  
                                                <div class="form-group">
                                                    <div class="col-md-3">
                                                        <label for="ida" class="control-label">Corr Img</label>
                                                        <h:outputText id="ida" value="#{movBienesBean.archSeleccionado.TArchId}" style="width: 100%;" class="form-control"/>    
                                                    </div>
                                                    <div class="col-md-3">
                                                        <label for="codia" class="control-label">Código</label>
                                                        <h:outputText id="codia" value="#{movBienesBean.archSeleccionado.TArchCodref}" style="width: 100%;" class="form-control"/>    
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label for="noma" class="control-label">Nombre del Archivo</label>
                                                        <h:outputText id="noma" value="#{movBienesBean.archSeleccionado.TArchNombre}" style="width: 100%;" class="form-control"/>    
                                                    </div>                                      
                                                </div> 
                                                <br></br>
                                                <div class="form-group">
                                                    <div class="col-md-6">
                                                        <label for="desci" class="control-label">Descripción</label>
                                                        <h:inputText id="desci" onkeyup="this.value = this.value.toUpperCase();" value="#{movBienesBean.archSeleccionado.TArchDesc}" style="width: 100%;" class="form-control"/> 
                                                    </div>        
                                                    <div class="col-md-3">
                                                        <label for="tipar" class="control-label">Archivo Tipo</label>
                                                        <h:selectOneMenu id="tipar" value="#{movBienesBean.archSeleccionado.TArchTipo}" style="width: 100%;" class="form-control">
                                                            <f:selectItem itemValue="F" itemLabel="Foto" />
                                                            <f:selectItem itemValue="D" itemLabel="Documento" />
                                                        </h:selectOneMenu>                                                
                                                    </div>                             
                                                    <div class="col-md-3">
                                                        <label for="ref" class="control-label">Referencia</label>
                                                        <h:outputText id="ref" value="#{movBienesBean.archSeleccionado.TArchTipref}" style="width: 100%;" class="form-control"/> 
                                                    </div>
                                                </div>
                                                <br></br>
                                                <div class="form-group">
                                                    <div class="col-md-6">
                                                    </div>                                                 
                                                    <div class="col-md-6">
                                                        <p:commandButton id="actuaI" icon="ui-icon-pencil" styleClass="btn btn-primary" value="Actualizar"  action="#{movBienesBean.actualA()}"  rendered="#{!movBienesBean.edit}" update="@all" process="@this :formImag:modImag:dispDoc2"  oncomplete="refrescarI(xhr, status, args); ;modifDoc.hide();" />
                                                        <script type="text/javascript">
                                                            function refrescarI(xhr, status, args) {
                                                                if (args.validationFailed) {
                                                                    alert('Ha ocurrido un error');
                                                                } else {
                                                                    alert('Datos actualizados correctamente');
                                                                    location.reload(true);
                                                                    modifDoc.hide();
                                                                }
                                                            }
                                                        </script>                                                    

                                                        <!--<p:commandButton value="Actualizar" icon="ui-icon-pencil" action="{bienesBean.actualA()}" rendered="{!bienesBean.edit}" update="@all" process="@this :formImag:dispDoc2"  oncomplete="modifDoc.hide();"/>-->
                                                    </div>                                             
                                                </div>
                                            </h:panelGroup>  
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Cancelar</button>
                                        </div>
                                    </h:form>
                                </div>
                            </div>
                        </div>
                        <div id="viewDoc" class="modal">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <h:head></h:head>
                                    <h:form id="verDoc" enctype="multipart/form-data"> 
                                        <p:growl id="growl" />
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                            <h4 class="modal-title">Descargar Documento o Imagen</h4>
                                        </div>
                                        <div class="modal-body">
                                            <h:panelGroup id="dispDocD"  >  
                                            </h:panelGroup>  
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Cancelar</button>
                                        </div>
                                    </h:form>
                                </div>
                            </div>
                        </div>
                        <div id="elimDoc" class="modal">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <h:head></h:head>
                                    <h:form id="elimImag" enctype="multipart/form-data">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                            <h4 class="modal-title">Eliminar Documento o Imagen</h4>
                                        </div>
                                        <div class="modal-body">
                                            <h:panelGroup id="dispDoc3" >  
                                                <div class="form-group">
                                                    <div class="col-md-3">
                                                        <label for="idae" class="control-label">Corr Img</label>
                                                        <h:outputText id="idae" value="#{movBienesBean.archSeleccionado.TArchId}" style="width: 100%;" class="form-control"/>    
                                                    </div>
                                                    <div class="col-md-3">
                                                        <label for="codiae" class="control-label">Código</label>
                                                        <h:outputText id="codiae" value="#{movBienesBean.archSeleccionado.TArchCodref}" style="width: 100%;" class="form-control"/>    
                                                    </div>
                                                    <div class="col-md-6">
                                                        <label for="nomae" class="control-label">Nombre del Archivo</label>
                                                        <h:outputText id="nomae" value="#{movBienesBean.archSeleccionado.TArchNombre}" style="width: 100%;" class="form-control"/>    
                                                    </div>                                      
                                                </div> 
                                                <br></br>
                                                <div class="form-group">
                                                    <div class="col-md-6">
                                                        <label for="descie" class="control-label">Descripción</label>
                                                        <h:inputText id="descie" onkeyup="this.value = this.value.toUpperCase();" value="#{movBienesBean.archSeleccionado.TArchDesc}" style="width: 100%;" class="form-control"/> 
                                                    </div>        
                                                    <div class="col-md-3">
                                                        <label for="tipare" class="control-label">Archivo Tipo</label>
                                                        <h:selectOneMenu id="tipare" value="#{movBienesBean.archSeleccionado.TArchTipo}" style="width: 100%;" class="form-control">
                                                            <f:selectItem itemValue="F" itemLabel="Foto" />
                                                            <f:selectItem itemValue="D" itemLabel="Documento" />
                                                        </h:selectOneMenu>                                                
                                                    </div>                             
                                                    <div class="col-md-3">
                                                        <label for="refe" class="control-label">Referencia</label>
                                                        <h:outputText id="refe" value="#{movBienesBean.archSeleccionado.TArchTipref}" style="width: 100%;" class="form-control"/> 
                                                    </div>
                                                </div>
                                                <br></br>
                                                <div class="form-group">
                                                    <div class="col-md-10">
                                                        <p:commandButton id="elimI" icon="ui-icon-delete" styleClass="btn btn-primary" value="Confirmar Eliminación Imagen"  action="#{movBienesBean.borrarA()}"  update="@this :formImag" process="@this :formImag:elimImag:dispDoc3"  oncomplete="refrescarIe(xhr, status, args); ;elimDoc.hide();" />
                                                        <script type="text/javascript">
                                                            function refrescarIe(xhr, status, args) {
                                                                if (args.validationFailed) {
                                                                    alert('Ha ocurrido un error');
                                                                } else {
                                                                    alert('Imagen eliminada correctamente');
                                                                    location.reload(true);
                                                                    elimDoc.hide();
                                                                }
                                                            }
                                                        </script>                                                    
                                                    </div>                                      
                                                </div>
                                            </h:panelGroup>  

                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Cancelar</button>
                                        </div>
                                    </h:form>
                                </div>
                            </div>
                        </div>


                    </h:form>

                </div>
                <div class="tab-pane fade" id="codigo">
                    <div class="well bs-component">

                        <h:form id="formCod" enctype="multipart/form-data" >
                            <p:growl id="growl" />
                            <legend>
                                <div class="form-header">
                                    <button type="button" class="close"  aria-hidden="true">Cancelar ×</button>
                                    <h4 class="modal-title">Consultar Datos de un Bien</h4>
                                </div>
                            </legend>
                            <div class="form-group">
                                <div class="col-md-3">
                                    <label for="codi" >Código</label>
                                    <div>
                                        <p:inputMask id="codi" value="#{movBienesBean.cod}" mask="99-9999-9999" style="width: 100%;"> 
                                            <p:ajax listener="#{movBienesBean.datosCodigo()}" update="@this descm marca modelo serie"/>
                                        </p:inputMask>
                                    </div>
                                </div>
                                <div class="col-md-5">
                                    <label for="descm" >Descripción</label>
                                    <div>
                                        <h:outputText id="descm" value="#{movBienesBean.codSeleccionado.TBienDesc}"  style="width: 100%;"/> 
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <label for="marca">Marca</label>
                                    <h:outputText id="marca" value="#{movBienesBean.codSeleccionado.CMarcaId.CMarcaDesc}"  style="width: 100%;"/> 
                                </div> 
                            </div> 
                            <div class="form-group">
                                 <div class="col-md-4">
                                    <label for="modelo" >Modelo</label>
                                    <h:outputText id="modelo" value="#{movBienesBean.codSeleccionado.TBienModelo}"  style="width: 100%;"/> 
                                    <div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <label for="serie" >Serie</label>
                                    <div>
                                        <h:outputText id="serie" value="#{movBienesBean.codSeleccionado.TBienSerie}"  style="width: 100%;"/> 
                                    </div>
                                </div>
                            </div>
                        </h:form>
                    </div>
                </div>
            </div>
        </ui:define>
        <ui:define name="scripts">
            <script>
                $(document).ready(function () {
                    $('.paginada').dataTable(
                            {
                                "oLanguage": {
                                    "sProcessing": "Procesando...",
                                    "sLengthMenu": "Mostrar _MENU_ registros",
                                    "sZeroRecords": "No se encontraron resultados",
                                    "sEmptyTable": "Ningún dato disponible en esta tabla",
                                    "sInfo": "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
                                    "sInfoEmpty": "Mostrando registros del 0 al 0 de un total de 0 registros",
                                    "sInfoFiltered": "(filtrado de un total de _MAX_ registros)",
                                    "sInfoPostFix": "",
                                    "sSearch": "Buscar:",
                                    "sUrl": "",
                                    "sInfoThousands": ",",
                                    "sLoadingRecords": "Cargando...",
                                    "oPaginate": {
                                        "sFirst": "Primero",
                                        "sLast": "Último",
                                        "sNext": "Siguiente",
                                        "sPrevious": "Anterior"
                                    },
                                    "oAria": {
                                        "sSortAscending": ": Activar para ordenar la columna de manera ascendente",
                                        "sSortDescending": ": Activar para ordenar la columna de manera descendente"
                                    }
                                }
                            }
                    );
                });
            </script>

        </ui:define>

    </ui:composition>
</html>
